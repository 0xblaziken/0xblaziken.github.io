<!DOCTYPE html>
<html>
<head>
  <title>WebView Listener Example</title>
  <style>
    #output {
    word-wrap: break-word;       
    overflow-wrap: break-word;  
    white-space: normal;         
    width: 100%;              
    box-sizing: border-box;      
}
  </style>
</head>
<body>
<h1>WebView JS Listener</h1>
  
  <button onclick="handleButton1()">Location</button>
<button onclick="handleButton2()">Device Info</button>
 <video id="video" autoplay playsinline style="width: 300px;"></video>
<canvas id="canvas" width="300" height="200" style="display:none;"></canvas>

<button id="snap">Take Photo</button>

<img id="capturedImage" style="width:300px; margin-top:10px;" />

<div id="output"></div>

<script>

 window.onload = function() {
            window.mfAppInterface.postMessage(JSON.stringify({"actionType":"beginChatParams","jsCallback":"getNativeInfo","AskvzTraceID":"1","key":null,"type":"log"}));
   
              };
  function handleButton1() {
    window.mfAppInterface.postMessage(JSON.stringify({actionType:"currentLatLng"}));
}

function handleButton2() {
    window.mfAppInterface.postMessage(JSON.stringify({actionType:"deviceDetails"}));
}
  
function getNativeInfo(data) {
    
    const output = document.getElementById('output');
    if (output) {
        output.innerText = data;
    }
}
navigator.mediaDevices.getUserMedia({ video: true })
    .then((stream) => {
      const video = document.getElementById("video");
      video.srcObject = stream;

      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const capturedImage = document.getElementById("capturedImage");

      // When button is clicked
      document.getElementById("snap").addEventListener("click", () => {
        // Draw current video frame to canvas
        ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

        // Convert canvas to image URL
        const dataUrl = canvas.toDataURL("image/png");

        // Show the image
        capturedImage.src = dataUrl;

        // Stop camera after capture
        stream.getTracks().forEach(track => track.stop());
      });
    })
    .catch((err) => {
      console.error("Camera error:", err);
    });


 
</script>

<div id="output"></div>
</body>
</html>
